#%%
import numpy as np

def printt(string):
    print()
    print('=' * 40)
    print(string)
    print('=' * 40)
    print()

def interpolation(x1, y1, x2, y2, x):
    return y1 + (x - x1) * (y2 - y1) / (x2 - x1)



M_1 = 2.5
delta = np.deg2rad(5)
chord = 0.2 # m
p_1 = 101325 # Pa
alpha = np.deg2rad(3)

#%%
# ------------------------------------------------------------------
printt('(1)')
# ------------------------------------------------------------------

p_o1__p_1 = 1.70859e+01
print(f'p_o1 / p_2: {p_o1__p_1:.4f}')

#%%
# ------------------------------------------------------------------
printt('(1) -> (2)')
# ------------------------------------------------------------------

beta_12 = np.deg2rad(25)
theta_12 = np.deg2rad(2)

M_12n = M_1 * np.sin(beta_12)

# (A.2)
# 1.04000e+00 1.09520e+00 1.06709e+00 1.02634e+00 9.99923e-01 1.98442e+00 9.62025e-01
# 1.06000e+00 1.14420e+00 1.10092e+00 1.03931e+00 9.99751e-01 2.03245e+00 9.44445e-01

p_2__p_1 = interpolation(1.04000e+00, 1.09520e+00,
                         1.06000e+00, 1.14420e+00,
                         M_12n)

p_o2__p_o1 = interpolation(1.04000e+00, 9.99923e-01, 
                           1.06000e+00, 9.99751e-01,
                           M_12n)

M_2n = interpolation(1.04000e+00, 9.62025e-01,
                     1.06000e+00, 9.44445e-01,
                     M_12n)


M_2 = M_2n / np.sin(beta_12 - theta_12)

# (A.1)
# 2.40000e+00 1.46200e+01 6.79369e+00 2.15200e+00 2.40310e+00
# 2.45000e+00 1.58061e+01 7.18296e+00 2.20050e+00 2.51683e+00

p_o2__p_2 = interpolation(2.40000e+00, 1.46200e+01,
                          2.45000e+00, 1.58061e+01,
                          M_2)

p_2__p_1 = (1 / p_o2__p_2) * p_o1__p_1

print(f'M_12n: {M_12n:.4f}')
print(f'p_2 / p_1: {p_o2__p_o1:.4f}')
print(f'p_o2 / p_o1: {p_2__p_1:.4f}')
print(f'M_2n: {M_2n:.4f}')
print(f'M_2: {M_2:.4f}')
print(f'p_o2 / p_2: {p_o2__p_2:.4f}')
print(f'p_2 / p_1: {p_2__p_1:.4f}')

#%%
# ------------------------------------------------------------------
printt('(2) -> (3)')
# ------------------------------------------------------------------

theta_23 = 10

# (A.5)
# 2.40000e+00 3.67465e+01 2.46243e+01
# 2.45000e+00 3.79459e+01 2.40895e+01

nu_2 = interpolation(2.40000e+00, 3.67465e+01,
                     2.45000e+00, 3.79459e+01,
                     M_2)

nu_3 = nu_2 + theta_23

# (A.5)
# 2.85000e+00 4.67779e+01 2.05410e+01
# 2.90000e+00 4.77903e+01 2.01713e+01
M_3 = interpolation(4.67779e+01, 2.85000e+00,
                    4.77903e+01, 2.90000e+00,
                    nu_3)

# (A.1)
# 2.85000e+00 2.92862e+01 1.11588e+01 2.62450e+00 3.67072e+00
# 2.90000e+00 3.15941e+01 1.17800e+01 2.68200e+00 3.84977e+00

p_o3__p_3 = interpolation(2.85000e+00, 2.92862e+01,
                          2.90000e+00, 3.15941e+01,
                          M_3)

p_3__p_1 = (1 / p_o3__p_3) * p_o1__p_1

print(f'nu_2: {nu_2:.4f}')
print(f'nu_3: {nu_3:.4f}')
print(f'M_3: {M_3:.4f}')
print(f'p_o3 / p_3: {p_o3__p_3:.4f}')
print(f'p_3 / p_1: {p_3__p_1:.4f}')

#%%
# ------------------------------------------------------------------
printt('(1) -> (4)')
# ------------------------------------------------------------------

beta_14 = np.deg2rad(35)
M_14n = M_1 * np.sin(beta_14)
theta_14 = np.deg2rad(13)

# (A.2)
# 1.42000e+00 2.18580e+00 1.72430e+00 1.26764e+00 9.53063e-01 3.11980e+00 7.31436e-01
# 1.44000e+00 2.25253e+00 1.75888e+00 1.28066e+00 9.47648e-01 3.19149e+00 7.23451e-01

p_4__p_1 = interpolation(1.42000e+00, 2.18580e+00,
                         1.44000e+00, 2.25253e+00,
                         M_14n)

p_o4__p_o1 = interpolation(1.42000e+00, 9.53063e-01, 
                           1.44000e+00, 9.47648e-01,
                           M_14n)

M_4n = interpolation(1.42000e+00, 7.31436e-01,
                     1.44000e+00, 7.23451e-01,
                     M_14n)


M_4 = M_4n / np.sin(beta_14 - theta_14)

# (A.1)
# 1.92000e+00 6.91106e+00 3.97809e+00 1.73728e+00 1.58039e+00
# 1.94000e+00 7.12843e+00 4.06707e+00 1.75272e+00 1.60617e+00
p_o4__p_4 = interpolation(1.92000e+00, 6.91106e+00,
                          1.94000e+00, 7.12843e+00,
                          M_4)

p_4__p_1 = (1 / p_o4__p_4) * p_o1__p_1

print(f'M_14n: {M_14n:.4f}')
print(f'p_4 / p_1: {p_o4__p_o1:.4f}')
print(f'p_o4 / p_o1: {p_4__p_1:.4f}')
print(f'M_4n: {M_4n:.4f}')
print(f'M_4: {M_4:.4f}')
print(f'p_o4 / p_4: {p_o4__p_4:.4f}')
print(f'p_4 / p_1: {p_4__p_1:.4f}')

#%%
# ------------------------------------------------------------------
printt('(4) -> (5)')
# ------------------------------------------------------------------

theta_45 = 10

# (A.5)
# 1.92000e+00 2.41506e+01 3.13882e+01
# 1.94000e+00 2.47123e+01 3.10285e+01

nu_4 = interpolation(1.92000e+00, 2.41506e+01,
                     1.94000e+00, 2.47123e+01,
                     M_4)

nu_5 = nu_4 + theta_45

# (A.5)
# 2.30000e+00 3.42828e+01 2.57715e+01
# 2.35000e+00 3.55255e+01 2.51843e+01
M_5 = interpolation(3.42828e+01, 2.30000e+00,
                    3.55255e+01, 2.35000e+00,
                    nu_5)

# (A.1)
# 2.30000e+00 1.25043e+01 6.07594e+00 2.05800e+00 2.19313e+00
# 2.35000e+00 1.35214e+01 6.42499e+00 2.10450e+00 2.29528e+00

p_o5__p_5 = interpolation(2.30000e+00, 1.25043e+01,
                          2.35000e+00, 1.35214e+01,
                          M_5)

p_5__p_1 = (1 / p_o5__p_5) * p_o1__p_1

print(f'nu_4: {nu_4:.4f}')
print(f'nu_5: {nu_5:.4f}')
print(f'M_5: {M_5:.4f}')
print(f'p_o5 / p_5: {p_o5__p_5:.4f}')
print(f'p_5 / p_1: {p_5__p_1:.4f}')

#%%
# ------------------------------------------------------------------
printt('Drag & lift')
# ------------------------------------------------------------------

thickness = 2 * np.sin(delta) * (chord / 2)

Axial = p_1 * (thickness / 2) * (p_2__p_1 + p_4__p_1 - p_3__p_1 - p_5__p_1)
Normal = p_1 * (chord / 2) * (p_4__p_1 + p_5__p_1 - p_2__p_1 - p_3__p_1)

Lift = Normal * np.cos(alpha) - Axial * np.sin(alpha)
Drag = Normal * np.sin(alpha) + Axial * np.cos(alpha)

print(f'thickness t: {thickness:.4f}')
print(f'Axial pressure [Pa]: {Axial:.2f}')
print(f'Normal pressure [Pa]: {Normal:.2f}')
print(f'Lift: {Lift:.2f}')
print(f'Drag: {Drag:.2f}')



#%%